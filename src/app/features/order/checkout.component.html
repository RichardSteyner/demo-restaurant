<div class="container mx-auto px-4 py-12">
	<!-- Order Confirmed State -->
	<div *ngIf="orderConfirmed" class="max-w-2xl mx-auto">
		<div class="bg-white rounded-lg shadow-lg p-8 text-center">
			<div class="text-6xl mb-4">✓</div>
			<h1 class="text-4xl font-bold text-accent mb-2">¡Pedido Confirmado!</h1>
			<p class="text-gray-600 text-lg mb-6">
				Gracias por tu compra. Tu pedido ha sido recibido y está siendo procesado.
			</p>

			<div class="bg-gray-100 rounded-lg p-6 mb-6">
				<p class="text-gray-700 mb-2">
					<strong>Número de Orden:</strong> <span class="text-accent font-bold">#{{ confirmedOrderId }}</span>
				</p>
				<p class="text-gray-700 mb-2">
					<strong>Nombre:</strong> {{ customerName }}
				</p>
				<p class="text-gray-700 mb-2">
					<strong>Email:</strong> {{ customerEmail }}
				</p>
				<p class="text-gray-700">
					<strong>Teléfono:</strong> {{ customerPhone }}
				</p>
			</div>

			<p class="text-gray-600 mb-8">
				Se ha enviado un email de confirmación a <strong>{{ customerEmail }}</strong>
			</p>

			<div class="flex flex-col gap-3">
				<button (click)="continueShopping()" routerLink="/menu" class="btn-primary">
					Continuar Comprando
				</button>
				<a routerLink="/" class="btn-secondary">
					Volver al Inicio
				</a>
			</div>
		</div>
	</div>

	<!-- Checkout Form -->
	<div *ngIf="!orderConfirmed" class="grid grid-cols-1 lg:grid-cols-3 gap-8">
		<!-- Form Section -->
		<div class="lg:col-span-2">
			<div class="bg-white rounded-lg shadow-lg p-8">
				<h1 class="text-3xl font-bold text-primary mb-6">Información de Pedido</h1>

				<form (ngSubmit)="submitOrder()" #checkoutForm="ngForm">
					<!-- Customer Info Section -->
					<div class="mb-8">
						<h2 class="text-xl font-bold text-primary mb-4">Datos Personales</h2>

						<div class="mb-4">
							<label class="block text-gray-700 font-semibold mb-2">Nombre Completo *</label>
							<input [(ngModel)]="customerName" name="name" type="text" placeholder="Juan Pérez"
								class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" />
						</div>

						<div class="mb-4">
							<label class="block text-gray-700 font-semibold mb-2">Email *</label>
							<input [(ngModel)]="customerEmail" name="email" type="email" placeholder="juan@example.com"
								class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" />
						</div>

						<div class="mb-4">
							<label class="block text-gray-700 font-semibold mb-2">Teléfono *</label>
							<input [(ngModel)]="customerPhone" name="phone" type="tel" placeholder="+1 (555) 123-4567"
								class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" />
						</div>
					</div>

					<!-- Payment Section -->
					<div class="mb-8">
						<h2 class="text-xl font-bold text-primary mb-4">Método de Pago</h2>

						<div class="space-y-3">
							<label
								class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
								<input [(ngModel)]="paymentMethod" name="payment" type="radio" value="credit-card"
									class="w-4 h-4" />
								<span class="ml-3 font-semibold">Tarjeta de Crédito</span>
							</label>

							<label
								class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
								<input [(ngModel)]="paymentMethod" name="payment" type="radio" value="debit-card"
									class="w-4 h-4" />
								<span class="ml-3 font-semibold">Tarjeta de Débito</span>
							</label>

							<label
								class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
								<input [(ngModel)]="paymentMethod" name="payment" type="radio" value="paypal"
									class="w-4 h-4" />
								<span class="ml-3 font-semibold">PayPal</span>
							</label>
						</div>
					</div>

					<!-- Buttons -->
					<div class="flex gap-3">
						<button [disabled]="isSubmitting" type="submit"
							class="btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed">
							{{ isSubmitting ? 'Procesando...' : 'Confirmar Pedido' }}
						</button>
						<a routerLink="/cart" class="btn-secondary flex-1 text-center">
							Volver al Carrito
						</a>
					</div>
				</form>
			</div>
		</div>

		<!-- Order Summary -->
		<div class="lg:col-span-1">
			<div class="bg-white rounded-lg shadow-lg p-6 sticky top-24">
				<h2 class="text-2xl font-bold text-primary mb-4">Resumen de Orden</h2>

				<div class="space-y-3 mb-6 pb-6 border-b">
					<div *ngFor="let item of (cartItems$ | async)">
						<div class="flex justify-between text-sm">
							<span>{{ item.product.name }} x{{ item.quantity }}</span>
							<span class="font-semibold">$ {{ (item.product.price * item.quantity).toFixed(2) }}</span>
						</div>
					</div>
				</div>

				<div class="space-y-2 mb-6 pb-6 border-b">
					<div class="flex justify-between">
						<span>Subtotal:</span>
						<span class="font-semibold">$ {{ (total$ | async)?.toFixed(2) }}</span>
					</div>
					<div class="flex justify-between">
						<span>Envío:</span>
						<span class="font-semibold">$ 5.00</span>
					</div>
					<div class="flex justify-between">
						<span>Impuestos (8%):</span>
						<span class="font-semibold">$ {{ ((total$ | async) ? ((total$ | async)! * 0.08).toFixed(2) :
							'0.00') }}</span>
					</div>
				</div>

				<div class="flex justify-between text-xl font-bold text-secondary">
					<span>Total:</span>
					<span>$ {{ ((total$ | async) ? ((total$ | async)! + 5 + ((total$ | async)! * 0.08)).toFixed(2) :
						'0.00') }}</span>
				</div>
			</div>
		</div>
	</div>
</div>